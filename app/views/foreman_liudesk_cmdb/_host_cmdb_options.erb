<%-
  item = %w[hosts discovered_hosts].include?(controller_name) ? @host : @hostgroup
  facet = item&.liudesk_cmdb_facet

  inherited = false
  if !item&.persisted?
    hostgroup = @hostgroup || @host&.hostgroup
    inherited = facet.nil?
    inherited ||= true if hostgroup&.inherited_facet_attributes(Facets.registered_facets[:liudesk_cmdb_facet])&.any?

    facet ||= item&.build_liudesk_cmdb_facet(hostgroup.inherited_facet_attributes(Facets.registered_facets[:liudesk_cmdb_facet])) if inherited && hostgroup
  end
-%>

<%= fields_for item do |f| %>
<%= f.fields_for 'liudesk_cmdb_facet_attributes' do |f| %>
<%= select_f(f, :asset_type, [ ['server', 'Server'], ['client', 'Client'] ], :first, :last,
      { include_blank: true,
        selected: facet&.asset_type,
        disable_button: _(HostsAndHostgroupsHelper::INHERIT_TEXT),
        disable_button_enabled: inherited,
      },
      { help_inline: :indicator,
        label: _('CMDB Asset Type'),
        label_help_options: { data: { placement: 'top' } },
      })
%>
<%= select_f(f, :network_role, ForemanLiudeskCMDB::API.network_access_roles, :to_s, :to_s,
      { include_blank: true,
        selected: facet&.network_role,
        disable_button: _(HostsAndHostgroupsHelper::INHERIT_TEXT),
        disable_button_enabled: inherited,
      },
      { help_inline: :indicator,
        label: _('CMDB Network Role'),
        label_help_options: { data: { placement: 'top' } },
      })
%>
<%-
  end
end
-%>
